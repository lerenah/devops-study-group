<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Thu Aug 27 21:20:45 2020 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>man</title>

</head>
<body>

<h1 align="center">man</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#THEORY OF OPERATION">THEORY OF OPERATION</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Nodeholder</b>
is a set of command line functions for securely configuring,
running and mointoring virtual private networks and
hosts.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>nodeholder-</b>[OPTIONS]</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>configure</b>
$ip config.sh</p>

<p style="margin-left:22%;">copies config.sh and runs it.
Disables root, creates admin account with original
root/.ssh/authorized_key. For now config.sh file must be in
the local directory where this is called.</p>

<p style="margin-left:11%;"><b>generate-aliases</b></p>

<p style="margin-left:22%;">Creates shell aliases to
&rsquo;functions at a distance&rsquo;. for example, alias
child-admin-init=&rsquo;ssh admin@child_ip
&rsquo;admin-init&rsquo;</p>

<p style="margin-left:11%;"><b>install-admin</b></p>

<p style="margin-left:22%;">copies admin.sh to admin
account and and runs it. The virtual private server is now a
nodeholder child that may host <b>nodes</b>.</p>

<p style="margin-left:11%;"><b>refresh-admin</b></p>

<p style="margin-left:22%;">copies admin.sh to admin
account, does not run it. Used for admin@nodeholder
acommands. The virtual private server is now a nodeholder
child that may host <b>nodes</b>.</p>

<p style="margin-left:11%;"><b>install-admin $ip</b></p>

<p style="margin-left:22%;">copies admin.sh and adds code
to source admin.sh in admin@$ip:admin.sh which enables
configuration at a distance via <b>nodeholder-</b>
commands.</p>

<p style="margin-left:11%;"><b>create-node</b> nodename</p>

<p style="margin-left:22%;">Creates a node (Unix user)
which hosts multiple apps.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ADMIN@$IP
OPTIONS</b> <br>
After child nodeholder at $ip is setup, you may use the
admin interface via admin@$ip &rsquo;admin-option&rsquo;
<b><br>
admin-create-app</b> $nodeName $repoURL $appName</p>

<p style="margin-left:22%;">If repo is private, make sure
you have added local public SSH key to
node@$ip:.ssh/authorized_keys. Upon completion, the repo
will be copied in a directory called appName containing
appName/nh directory. This nh directory contains files
copied from admin@$mother/buildpak.</p>

<p style="margin-left:11%;"><b>admin-create-port</b></p>

<p style="margin-left:22%;">Generates a port number, marks
it as used, adds to admin@$ip:ports/</p>

<p style="margin-left:11%;"><b>admin-delete-port</b></p>

<p style="margin-left:22%;">Frees a system port.</p>

<p style="margin-left:11%;"><b>admin-delete-app</b></p>

<p style="margin-left:22%;">Frees port and deletes
repo.</p>

<h2>THEORY OF OPERATION
<a name="THEORY OF OPERATION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">nodeholder-config
usese scp to copy and execute the config.sh file on
root@child. After this one-time process is complete, the
root account is disbled and only the admin user can
authenticate with SSHd on the child.</p>


<p style="margin-left:11%; margin-top: 1em">nodeholder-install-admin
$ip copies admin.sh and adds code to source admin.sh in
admin@$ip:admin.sh which enables configuration at a distance
via <b>nodeholder-</b>* commands.</p>


<p style="margin-left:11%; margin-top: 1em">nodeholder-create-node
creates a node (implemented as unix user with no password)
that can hold multiple apps with one port per app. Typically
multiple users would provide public SSH keys that are added
to node@$ip:./ssh/authorized_keys. This allows teams to
share a node for multiple network apps.</p>


<p style="margin-left:11%; margin-top: 1em">admin-create-app
creates network-aware applications under nodes which are
controlled remotely via
node@$ip:node/app/nh/{start,stop,status}</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">dotool(8)</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">No known bugs
(Ha!).</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Mike Ricos
(mike@lenan.net), Zach Overhulser (zoverlvx@gmail.com)</p>
<hr>
</body>
</html>
